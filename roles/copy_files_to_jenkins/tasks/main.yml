---
- name: copy roles to jenkins
  synchronize: 
    src: "{{project_directory}}/roles"
    dest: /var/lib/jenkins/
    rsync_opts:
      - "--exclude=node_modules"
  become: true
#    owner: ubuntu
#    group: ubuntu
#    mode: 0666


- name: copy files necessary to deploy itrust and checkbox 
  copy:
    src: "{{ project_directory }}/app_deploy/"
    dest: /var/lib/jenkins/
    owner: ubuntu
    group: ubuntu
    mode: 0666
  become: true

#- name: copy files necessary to run ec2instance
#  synchronize:
#    src: ~/deploy_app_iTrust2.yml
#    dest: ~/deploy_app_iTrust2.yml
#    owner: ubuntu
#    group: ubuntu
#    mode: 0666

- name: copying additional necessary files
  copy:
    src: "{{ project_directory }}/provision_ec2.yml"
    dest: /var/lib/jenkins/provision_ec2.yml
    owner: ubuntu
    group: ubuntu
    mode: 0666
  become: true

- name: copy aws files
  copy:
    src: ~/.aws/
    dest: /var/lib/jenkins/.aws/
    owner: ubuntu
    group: ubuntu
    mode: 0400
  become: true


- name: copy vault
  copy:
    src: ~/.vault_pass.txt
    dest: /var/lib/jenkins/.vault_pass.txt
    owner: ubuntu
    group: ubuntu
    mode: 0400
  become: true

- name: Copy pom-data.xml for iTrustv2
  copy:
    src: ~/DevOps-Project/roles/copy_files_to_jenkins/templates/pom-data.xml
    dest: /home/ubuntu/pom-data.xml
    owner: ubuntu
    group: ubuntu
    mode: 0666
  become: true

- name: Copy localinventory for localhost of Jenkins EC2
  copy:
    src: "{{ project_directory }}/roles/copy_files_to_jenkins/templates/local_inventory"
    dest: /home/ubuntu/local_inventory
    owner: ubuntu
    group: ubuntu
    mode: 0666
  become: true

#Job Builder Playbook for iTrust Test
- name: Copy set_itrust_properties.yml
  copy:
    src: "{{ project_directory }}/roles/copy_files_to_jenkins/templates/set_itrust_properties.yml"
    dest: /home/ubuntu/set_itrust_properties.yml
    owner: ubuntu
    group: ubuntu
    mode: 0666
  become: true

#Job Builder Playbook for iTrust Fuzzing
- name: Copy set_itrust_properties.yml
  copy:
    src: "{{ project_directory }}/roles/copy_files_to_jenkins/templates/build_itrust_fuzzer_job.yml"
    dest: /home/ubuntu/build_itrust_fuzzer_job.yml
    owner: ubuntu
    group: ubuntu
    mode: 0666
  become: true


